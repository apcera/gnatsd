# Copyright 2016 Apcera Inc. All rights reserved.

listen: 127.0.0.1:4233
http: 127.0.0.1:8233

authorization {

  super_user = {
    publish = ["*", ">", "PUBLIC.>"]
    subscribe = ">"
  }

  req_pub_user = {
    publish = ["req.foo", "req.bar"]
    subscribe = "_INBOX.>"
  }

   default_user = {
    publish = ["req.foo", "req.bar"]
    subscribe = "PUBLIC.>"
  }

  default_permissions: $default_user


  oauth2_user = {
    publish = ["req.foo", "req.bar"]
    subscribe = ["req.foo", "req.bar", "_INBOX.>"]
  }

  dynamic_user: true

  oauth2_authenticator1 = "nats://localhost:4333"
  oauth2_authenticator2 = "nats://alice:foo@localhost:4233"
  oauth2_authenticator3 = "nats://localhost:4222"

  authenticator_hub = [
    $oauth2_authenticator1
  ]

  # Just foo for testing
  # pass: 248%BH7fZhfdOh6h%P3JDa
  # bcrypt hash: $2a$11$b0PUYclUQ3YOdqI3PkosC.tbbmTTAUCKb5xJwFtQIokrxPFeiIoae
  PASS: $2a$11$b0PUYclUQ3YOdqI3PkosC.tbbmTTAUCKb5xJwFtQIokrxPFeiIoae

  users = [
    {user: alice, password: foo, permissions: $super_user}
    {user: bob,   password: bar, permissions: $req_pub_user}
    {user: susan, password: baz}
    {token: $PASS, permissions: $oauth2_user}
    {user: vincent.*, password: foo, authenticator:"oauth.replier"}
    {token: normaluser1*, authenticator:"oauth2.replier"}
    {token: normaluser2*, authenticator:"oauth2.replier"}
  ]

}
